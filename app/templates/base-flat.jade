mixin accountLinks
  li
    a(href="/user/#{me.getSlugOrID()}", data-i18n="nav.profile")
  li
    a(href="/account/settings", data-i18n="play.settings")
  if me.isAdmin() || !(me.isTeacher() || me.isStudent() || me.freeOnly())
    li
      a(href="/account/payments", data-i18n="account.payments")
  if me.isAdmin() || !(me.isTeacher() || me.isStudent() || me.freeOnly()) || me.hasSubscription()
    li
      a(href="/account/subscription", data-i18n="account.subscription")
  if me.isAdmin()
    li
      a(href="/admin", data-i18n="account_settings.admin")
  if serverSession && serverSession.amActually
    li
      a#nav-stop-spying-button Stop Spying
  if !features.codePlay
    li
      a#logout-button(data-i18n="login.log_out")

.style-flat
  block header
    nav#main-nav.navbar.navbar-default
      .container-fluid.container
        .row
          .col-md-12
            .navbar-header
              button.navbar-toggle.collapsed(data-toggle='collapse', data-target='#navbar-collapse' aria-expanded='false')
                span.sr-only(data-i18n="nav.toggle_nav")
                span.icon-bar
                span.icon-bar
                span.icon-bar
              a.navbar-brand(href="/home")
                if serverConfig.codeNinjas
                  img#logo-img.code-ninjas-powered-by(src="/images/pages/base/logo.png")
                  img.code-ninjas-logo(src="/images/pages/base/code-ninjas-logo-right.png")
                else
                  img#logo-img(src="/images/pages/base/logo.png")
                span.glyphicon.glyphicon-home
            if !serverConfig.static
              #navbar-collapse.collapse.navbar-collapse
                ul.nav.navbar-nav
                  li(style="display:none")
                    a(href="/about", data-i18n="nav.about")
                  if me.isStudent()
                    li
                      a(href="/students", data-i18n="nav.my_courses")
                  if !me.isAnonymous() && me.isTeacher()
                    li
                      a(href="/teachers/classes", data-i18n="nav.my_classrooms")
                  if !me.isAnonymous() && !me.isStudent() && !me.isTeacher()
                    li
                      a(href="/play", data-i18n="common.play")
                    //li(style="display:none")
                    //  a(href=view.forumLink(), data-i18n="nav.forum")
                if me.isAnonymous()
                  ul.nav.navbar-nav
                    li
                      a#create-account-link.signup-button(data-i18n="login.sign_up")
                    li
                      a#login-link.login-button(data-i18n="login.log_in")
                else
                  ul.nav.navbar-nav.hidden-md.hidden-lg
                    li.disabled
                      a
                        img.img-circle.img-circle-small.m-r-1(src=me.getPhotoURL() class=(me.isTeacher() ? 'border-navy' : ''))
                        span= me.displayName()
                    +accountLinks

                  ul.nav.navbar-nav
                    li.dropdown.hidden-xs.hidden-sm
                      a.dropdown-toggle(href="#", data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false")
                        img.img-circle.img-circle-small.m-r-1(src=me.getPhotoURL() class=(me.isTeacher() ? 'border-navy' : ''))
                        span(data-i18n="nav.my_account")
                      ul.dropdown-menu
                        li.user-dropdown-header.text-center
                          span.user-level= me.level()
                          a(href="/user/#{me.getSlugOrID()}")
                            img.img-circle(src=me.getPhotoURL() class=(me.isTeacher() ? 'border-navy' : ''))
                          h5=me.broadName()
                        +accountLinks

                ul.nav.navbar-nav
                  li
                    #language-dropdown-wrapper
                      select.language-dropdown.form-control

  block page_nav

  block outer_content
    #site-content-area
      block content
        p If this is showing, you dun goofed

  block footer
    .container-fluid
      #final-footer.small.text-center(dir="ltr")
        | Copyright Â©2017 CodeCombat. All Rights Reserved.
        br.hidden-lg.hidden-md
        img(src="/images/pages/base/logo.png" alt="CodeCombat")
        br.hidden-lg.hidden-md
        if !me.isStudent()
          .contact-info.rtl-allowed
            //span.spr(data-i18n="nav.help_pref")
            //- var supportEmail = (me.get('preferredLanguage', true) || 'en-US').split('-')[0] == 'nl' ? 'klantenservice@codecombat.nl' : 'team@codecombat.com';
            //a(href="mailto:" + supportEmail)= supportEmail
            //span.spl(data-i18n="nav.help_suff")
div.hide
  script(src="https://s22.cnzz.com/z_stat.php?id=1271215109&web_id=1271215109")